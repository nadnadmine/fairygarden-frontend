<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=1440">
  <title>Our Products - Fairy Garden</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Metal&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="viewall.css">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body>
<!-- ========== HEADER DAN AUTH ========= -->
  <div id="header-container"></div>
  <div id="auth-container"></div>

  <!-- ========== LOAD HEADER ========== -->
  <script>
    fetch("header.html")
      .then(res => res.text())
      .then(html => {
        document.getElementById("header-container").innerHTML = html;

        // User icon logic
        const userIcon = document.querySelector(".fa-user").parentElement;
        if (userIcon) {
          userIcon.addEventListener("click", function (e) {
            e.preventDefault();

            const loggedIn = localStorage.getItem("isLoggedIn") === "true";

            if (loggedIn) {
              window.location.href = "profile.html";
            } else {
              document.getElementById("loginModal").classList.add("show");
            }
          });
        }

        // Dropdowns
        const dropdowns = document.querySelectorAll(".dropdown");
        dropdowns.forEach(dd => {
          dd.addEventListener("mouseenter", () => {
            dd.querySelector(".dropdown-menu").style.display = "block";
          });
          dd.addEventListener("mouseleave", () => {
            dd.querySelector(".dropdown-menu").style.display = "none";
          });
        });
      });
  </script>

  <!-- ========== LOAD MODAL AUTH ========== -->
  <script>
    fetch("modal-auth.html")
      .then(res => res.text())
      .then(html => {
        const container = document.getElementById("auth-container");
        container.innerHTML = html;

        // Jalankan semua <script> yg ada di modal-auth.html
        const scripts = container.querySelectorAll("script");
        scripts.forEach(oldScript => {
          const newScript = document.createElement("script");
          newScript.textContent = oldScript.textContent;
          document.body.appendChild(newScript);
        });
      });
  </script>

  <!-- ===== VIEW ALL PRODUCTS ===== -->
  <section class="all-products">
    <h2 class="section-title">Our Products</h2>
    <div id="viewall-grid" class="products-grid"></div>
  </section>

  <!-- FOOTER -->
  <footer>
    <p><b>YOU CAN FIND US ON</b></p>
    <p>
      <i class="fa-brands fa-instagram"></i> @fairygarden &nbsp;&nbsp;
      <i class="fa-regular fa-envelope"></i> fairygarden@gmail.com
    </p>
  </footer>

  <!-- === PRODUCT GRID SCRIPT === -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
  const grid = document.getElementById("viewall-grid");
  if (!grid) return;

  // Ambil data produk dari localStorage
  let products = JSON.parse(localStorage.getItem("products")) || [];

  // Kalau masih kosong (pertama kali load), isi defaultProducts
  if (products.length === 0) {
    products = defaultProducts; // boleh diambil dari file lain
    localStorage.setItem("products", JSON.stringify(products));
  }

  // Render produk
  grid.innerHTML = products.map(p => `
    <a href="product-detail.html?id=${p.id}" class="product-card">
      <div class="product-box">
        <img src="${p.img}" alt="${p.name}">
      </div>
      <b>${p.name}</b>
      <div>Rp. ${Number(p.price).toLocaleString("id-ID")}</div>
    </a>
  `).join("");
});
  </script>

</body>
</html>