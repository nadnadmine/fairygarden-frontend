<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=1440">
  <title>Fairy Garden</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Jacquarda+Bastarda+9&family=Metal&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <div id="auth-container"></div>

  <div class="top-bar">
    Place an order online for Delivery or Pick Up, or contact us at +62 812 3456 7890
  </div>

  <header>
    <h1 class="logo">Fairy Garden</h1>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li class="dropdown">
          <a href="#">Occasions</a>
          <ul class="dropdown-menu">
            <li><a href="occasions.html?category=birthday">Birthday</a></li>
            <li><a href="occasions.html?category=mothersday">Mother‚Äôs Day</a></li>
            <li><a href="occasions.html?category=justbecause">Just Because</a></li>
            <li><a href="occasions.html?category=anniversary">Anniversary</a></li>
            <li><a href="occasions.html?category=graduation">Graduation</a></li>
            <li><a href="occasions.html">Explore All Occasions</a></li>
          </ul>
        </li>
        <li><a href="about.html">About Us</a></li>
      </ul>
    </nav>
    <div class="header-icons">
      <a href="#" id="userButton"><i class="fa-regular fa-user"></i></a>
      <a href="cart.html"><i class="fa-solid fa-cart-shopping"></i></a>
    </div>
  </header>

  <section class="hero" style="background:url('https://i.pinimg.com/1200x/87/68/f4/8768f444375a92fde9404f7ecf672b2a.jpg') center/cover no-repeat;">
    <div class="hero-content">
      <div class="search-container">
        <input type="text" id="homeSearchInput" placeholder="Search..." class="search-input">
        <i class="fa-solid fa-magnifying-glass search-icon" id="homeSearchBtn"></i>
      </div>
    </div>
  </section>

  <section class="promises">
    <h2 class="section-title">Our Promises</h2>
    <div class="promises-grid">
      <div class="promise"><div class="circle">üíê</div><p>Freshness Guaranteed</p></div>
      <div class="promise"><div class="circle">‚è∞</div><p>On-Time Delivery</p></div>
      <div class="promise"><div class="circle">ü§ç</div><p>Personal Touch in Every Bouquet</p></div>
      <div class="promise"><div class="circle">üå∏</div><p>Satisfaction & Care</p></div>
    </div>
  </section>

  <section class="popular">
    <h2 class="section-title">Our Most Popular Bouquets</h2>
    
    <div class="products-grid" id="homeProductContainer">
        <p style="text-align:center; width:100%;">Memuat produk terbaru...</p>
    </div>

    <a href="viewall.html" class="btn">View All Products</a>
  </section>

  <section class="about-section">
    <div class="about-left">
      <div class="about-text">
        <h4>About Us</h4>
        <p>Fairy Garden adalah rumah bunga yang berlokasi di Jakarta Selatan. Kami menghadirkan rangkaian bunga cantik untuk setiap momen spesial anda.</p>
      </div>
      <img class="about-box" src="https://i.pinimg.com/1200x/75/f6/de/75f6ded737f911c25ee9f43505a7c0fd.jpg" alt="Flower Shop">
    </div>
    <div class="about-right">
      <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d126906.96295482372!2d106.7196755606336!3d-6.28410002272969!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2e69f1ec2422b0b3%3A0x396342e94a4b5c9b!2sSouth%20Jakarta%2C%20South%20Jakarta%20City%2C%20Jakarta!5e0!3m2!1sen!2sid!4v1700000000000!5m2!1sen!2sid" 
              class="about-box" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
      <div class="contact">
        <h4>Where To Find Us</h4>
        <p class="phone">+62 812 3456 7890</p>
      </div>
    </div>
  </section>

  <footer>
    <p><b>YOU CAN FIND US ON</b></p>
    <p><i class="fa-brands fa-instagram"></i> @fairygarden &nbsp;&nbsp; <i class="fa-regular fa-envelope"></i> fairygarden@gmail.com</p>
  </footer>

  <script src="script.js"></script>
  
  <script>
    fetch("modal-auth.html").then(res=>res.text()).then(html=>{ document.getElementById("auth-container").innerHTML = html; });

    // Load Popular Products (8 Teratas)
    document.addEventListener("DOMContentLoaded", async () => {
        const container = document.getElementById("homeProductContainer");
        if(!container) return;

        try {
            // Ambil Data dari API Vercel (Database Asli)
            const res = await fetch("https://fairygarden-backend.vercel.app/api/products");
            if(!res.ok) throw new Error("Gagal fetch");
            
            const data = await res.json();
            
            // Ambil 8 produk pertama saja
            const popular = data.slice(0, 8); 

            container.innerHTML = ""; // Bersihkan loading

            popular.forEach(p => {
                // Fix Gambar URL
                let img = p.image_url;
                if(img && !img.startsWith('http')) {
                    img = "https://fairygarden-backend.vercel.app/uploads/" + img;
                }

                // Buat HTML Card (Link ?id=ANGKA)
                const card = `
                  <div class="product-card">
                    <a href="product-detail.html?id=${p.product_id}">
                      <img src="${img}" alt="${p.product_name}">
                      <b>${p.product_name}</b>
                      <div>Rp. ${parseInt(p.price).toLocaleString("id-ID")}</div>
                    </a>
                  </div>
                `;
                container.innerHTML += card;
            });

        } catch (err) {
            container.innerHTML = "<p>Gagal memuat produk.</p>";
            console.error(err);
        }
    });
  </script>
</body>
</html>